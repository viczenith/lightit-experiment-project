"use strict";(self.webpackChunklightit=self.webpackChunklightit||[]).push([[162],{7162:(e,s,t)=>{t.r(s),t.d(s,{default:()=>v});var a=t(5043),r=t(3721),l=t(5187),i=t(4362),n=t(9379),c=t(3546),o=t(5487),d=t(579);function u(e){let{steps:s,currentStep:t}=e;const a=t/(s.length-1)*100;return(0,d.jsx)("div",{className:"w-full",children:(0,d.jsxs)("div",{className:"flex justify-between mb-2 relative",children:[s.map((e,a)=>(0,d.jsxs)("div",{className:"relative z-10 flex flex-col items-center",style:{width:"".concat(100/(s.length-1),"%")},children:[(0,d.jsx)(o.P.div,{animate:{scale:t===a?1.2:1,backgroundColor:t>=a?"#4CC9F0":"#E5E7EB"},className:"w-8 h-8 rounded-full flex items-center justify-center text-white font-bold mb-1",children:a+1}),(0,d.jsx)("span",{className:"text-xs text-center ".concat(t===a?"font-bold text-science-blue":"text-gray-500"),children:e})]},a)),(0,d.jsx)("div",{className:"absolute top-4 left-0 right-0 h-1 bg-gray-200",children:(0,d.jsx)(o.P.div,{className:"h-full bg-science-blue",initial:{width:0},animate:{width:"".concat(a,"%")},transition:{duration:.5}})})]})})}var m=t(8430),x=t(6381);const p=["Experiment Details","Media Content","Procedure","Safety & Results","Review"];function h(e){let{onSubmit:s,isSubmitting:t}=e;const[r,l]=(0,a.useState)(0),[i,h]=(0,a.useState)({title:"",grade:"",subject:"",description:"",video:"",images:[],materials:[""],procedure:"",precautions:"",results:"",discussion:""}),[b,g]=(0,a.useState)({}),j=(0,a.useRef)(null),[v,f]=(0,a.useState)(!1),y=(e,s)=>{h(t=>(0,n.A)((0,n.A)({},t),{},{[e]:s})),g(s=>(0,n.A)((0,n.A)({},s),{},{[e]:void 0}))},N=e=>{const s=Array.from(e).filter(e=>e.type.startsWith("image/"));s.length&&h(e=>(0,n.A)((0,n.A)({},e),{},{images:[...e.images,...s]}))};return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)(u,{steps:p,currentStep:r}),(0,d.jsx)(c.N,{mode:"wait",children:(0,d.jsxs)(o.P.div,{initial:{x:100,opacity:0},animate:{x:0,opacity:1},exit:{x:-100,opacity:0},transition:{duration:.3},className:"pt-4",children:[0===r&&(0,d.jsx)("div",{className:"space-y-4",children:[["title","Experiment Title *"],["grade","Grade Level *"],["subject","Subject *"],["description","Description *"]].map(e=>{let[s,t]=e;return(0,d.jsx)(m.A,{label:t,name:s,type:"description"===s?"textarea":"grade"===s||"subject"===s?"select":"text",options:"grade"===s?["7","8","9","10","11","12"]:"subject"===s?["Physics","Chemistry","Biology"]:void 0,value:i[s],onChange:(e,s)=>y(e,s),error:b[s],required:!0,rows:"description"===s?3:void 0},s)})}),1===r&&(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)(m.A,{label:"Video URL (YouTube)",name:"video",value:i.video,onChange:(e,s)=>y(e,s),placeholder:"https://www.youtube.com/watch?v=..."}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Experiment Images"}),(0,d.jsxs)("div",{onClick:()=>j.current.click(),onDragOver:e=>{e.preventDefault(),f(!0)},onDragLeave:()=>f(!1),onDrop:e=>{e.preventDefault(),f(!1),e.dataTransfer.files.length&&N(e.dataTransfer.files)},className:"cursor-pointer border-2 border-dashed rounded-xl w-full min-h-48 flex flex-col items-center justify-center ".concat(v?"border-blue-500 bg-blue-50":"border-gray-300 bg-gray-100"),children:[(0,d.jsx)("input",{type:"file",multiple:!0,accept:"image/*",className:"hidden",ref:j,onChange:e=>N(e.target.files)}),(0,d.jsxs)("p",{className:"text-gray-600",children:[(0,d.jsx)("span",{className:"font-medium text-blue-600",children:"Click or drag"})," to add images"]})]}),i.images.length>0&&(0,d.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:i.images.map((e,s)=>(0,d.jsxs)("div",{className:"relative group w-16 h-16",children:[(0,d.jsx)("img",{src:URL.createObjectURL(e),alt:"",className:"object-cover w-full h-full rounded"}),(0,d.jsx)("button",{onClick:()=>h(e=>{const t=[...e.images];return t.splice(s,1),(0,n.A)((0,n.A)({},e),{},{images:t})}),className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-5 h-5 opacity-0 group-hover:opacity-100",children:"\xd7"})]},s))})]})]}),2===r&&(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Materials Used"}),(0,d.jsxs)("div",{className:"space-y-2",children:[i.materials.map((e,s)=>(0,d.jsxs)("div",{className:"flex",children:[(0,d.jsx)("input",{type:"text",value:e,placeholder:"Material ".concat(s+1),onChange:e=>((e,s)=>h(t=>{const a=[...t.materials];return a[e]=s,(0,n.A)((0,n.A)({},t),{},{materials:a})}))(s,e.target.value),className:"flex-1 border rounded-l px-4 py-2"}),(0,d.jsx)("button",{onClick:()=>(e=>h(s=>{const t=s.materials.filter((s,t)=>t!==e);return(0,n.A)((0,n.A)({},s),{},{materials:t.length?t:[""]})}))(s),disabled:i.materials.length<=1,className:"bg-red-500 text-white px-3 rounded-r",children:"\xd7"})]},s)),(0,d.jsx)(x.A,{type:"button",onClick:()=>h(e=>(0,n.A)((0,n.A)({},e),{},{materials:[...e.materials,""]})),children:"+ Add Material"})]})]}),(0,d.jsx)(m.A,{label:"Procedure *",name:"procedure",type:"textarea",rows:6,value:i.procedure,onChange:(e,s)=>y(e,s),error:b.procedure,required:!0,placeholder:"Enter each step on a new line"})]}),3===r&&(0,d.jsx)("div",{className:"space-y-4",children:["precautions","results","discussion"].map(e=>(0,d.jsx)(m.A,{label:"".concat(e.charAt(0).toUpperCase()+e.slice(1)," *"),name:e,type:"textarea",rows:4,value:i[e],onChange:(e,s)=>y(e,s),error:b[e],required:!0},e))}),4===r&&(0,d.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-inner space-y-4",children:[(0,d.jsx)("h3",{className:"text-xl font-bold",children:"Review Your Experiment"}),Object.entries(i).map(e=>{let[s,t]=e;return"images"===s||"materials"===s?null:(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:"font-semibold text-gray-600",children:s.charAt(0).toUpperCase()+s.slice(1)}),(0,d.jsx)("p",{className:"whitespace-pre-wrap",children:t||(0,d.jsx)("span",{className:"text-red-400",children:"Not provided"})})]},s)}),i.images.length>0&&(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:"font-semibold",children:"Images"}),(0,d.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:i.images.map((e,s)=>(0,d.jsx)("img",{src:URL.createObjectURL(i.images[s]),className:"w-16 h-16 rounded"},s))})]}),i.materials.some(e=>e.trim())&&(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:"font-semibold",children:"Materials"}),(0,d.jsx)("ul",{className:"list-disc pl-5",children:i.materials.filter(e=>e.trim()).map((e,s)=>(0,d.jsx)("li",{children:e},s))})]})]})]},r)}),(0,d.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,d.jsx)(x.A,{onClick:()=>l(e=>Math.max(e-1,0)),disabled:0===r||t,children:"Previous"}),r===p.length-1?(0,d.jsx)(x.A,{onClick:()=>s(i),loading:t,disabled:t,className:"bg-green-500 hover:bg-green-600 disabled:bg-green-400",children:"Submit"}):(0,d.jsx)(x.A,{onClick:()=>{(()=>{const e={};return 0===r&&["title","grade","subject","description"].forEach(s=>{var t;null!==(t=i[s])&&void 0!==t&&t.trim()||(e[s]="Required")}),2!==r||i.procedure.trim()||(e.procedure="Required"),3===r&&["precautions","results","discussion"].forEach(s=>{i[s].trim()||(e[s]="Required")}),g(e),!Object.keys(e).length})()&&l(e=>Math.min(e+1,p.length-1))},disabled:t,children:"Next"})]})]})}var b=t(3204);function g(e){let{isOpen:s,onClose:t,title:a,children:r}=e;return s?(0,d.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,d.jsxs)(o.P.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-2xl shadow-xl w-full max-w-md",children:[(0,d.jsxs)("div",{className:"border-b p-4 flex justify-between items-center",children:[(0,d.jsx)("h3",{className:"text-xl font-bold",children:a}),(0,d.jsx)("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:(0,d.jsx)(b.QCr,{})})]}),(0,d.jsx)("div",{className:"p-4",children:r})]})}):null}var j=t(6536);function v(){const e=(0,r.Zp)(),{user:s}=(0,l.A)(),{fetchExperiments:t}=(0,i.W)(),[n,c]=(0,a.useState)(!1),[o,u]=(0,a.useState)(!1),[m,x]=(0,a.useState)(null);return(0,d.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-10",children:[(0,d.jsx)("h1",{className:"text-3xl font-bold text-center mb-8",children:"Upload New Experiment"}),(0,d.jsx)(h,{onSubmit:async e=>{c(!0);try{const a=await Promise.all(e.images.map(e=>new Promise((s,t)=>{const a=new FileReader;a.onload=()=>s(a.result),a.onerror=()=>t(new Error("File read error")),a.readAsDataURL(e)}))),r={title:e.title,grade:e.grade,subject:e.subject,description:e.description,videoUrl:e.video,images:a,materials:e.materials.filter(e=>e.trim()),procedure:e.procedure,precautions:e.precautions,results:e.results,discussion:e.discussion,createdBy:s.id},l=(await j.A.post("/experiments",r)).data;x(l),t(),u(!0)}catch(l){var a,r;console.error("Submission error:",l);const e=null===(a=l.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message;alert(e?"Submission failed: ".concat(e):"An unexpected error occurred during submission. Please check console and try again.")}finally{c(!1)}},isSubmitting:n}),o&&m&&(0,d.jsx)(g,{isOpen:!0,onClose:()=>u(!1),title:"Upload Successful",children:(0,d.jsxs)("div",{className:"text-center p-6",children:[(0,d.jsx)("div",{className:"text-5xl mb-4",children:"\ud83c\udf89"}),(0,d.jsx)("h3",{className:"text-xl font-bold mb-2",children:"Experiment Submitted!"}),(0,d.jsxs)("p",{className:"text-gray-600 mb-6",children:['"',m.title,'" has been created successfully.']}),(0,d.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,d.jsx)("button",{className:"btn-primary px-6 py-3",onClick:()=>{u(!1),e("/experiments/".concat(m.grade,"/").concat(encodeURIComponent(m.title),"/").concat(m._id))},children:"View"}),(0,d.jsx)("button",{className:"btn-secondary px-6 py-3",onClick:()=>{u(!1),e("/educator/experiments")},children:"My Experiments"})]})]})})]})}},8430:(e,s,t)=>{t.d(s,{A:()=>o});var a=t(9379),r=t(3986),l=t(5043),i=t(5487),n=t(579);const c=["label","type","value","onChange","options","name"];function o(e){let{label:s,type:t="text",value:o,onChange:d,options:u=[],name:m}=e,x=(0,r.A)(e,c);const[p,h]=(0,l.useState)(!1),b=e=>{d(m,e.target.value)};return(0,n.jsx)("div",{className:"relative",children:"select"===t?(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("select",(0,a.A)((0,a.A)({name:m,value:o,onChange:e=>{d(m,e.target.value)},onFocus:()=>h(!0),onBlur:()=>h(!1),className:"w-full pt-5 pb-2 px-4 border border-gray-300 rounded-lg bg-transparent appearance-none focus:outline-none focus:ring-2 focus:ring-science-blue focus:border-transparent"},x),{},{children:[(0,n.jsx)("option",{value:"",disabled:!0,hidden:!0}),u.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})),(0,n.jsx)(i.P.label,{initial:{y:18,x:16,scale:1},animate:p||o?{y:4,x:12,scale:.85}:{},className:"absolute left-0 pointer-events-none ".concat(p||o?"text-science-blue":"text-gray-500"),children:s}),(0,n.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:(0,n.jsx)("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]}):"textarea"===t?(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("textarea",(0,a.A)({name:m,value:o,onChange:b,onFocus:()=>h(!0),onBlur:()=>h(!1),className:"w-full pt-5 pb-2 px-4 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-science-blue focus:border-transparent"},x)),(0,n.jsx)(i.P.label,{initial:{y:18,x:16,scale:1},animate:p||o?{y:4,x:12,scale:.85}:{},className:"absolute left-0 pointer-events-none ".concat(p||o?"text-science-blue":"text-gray-500"),children:s})]}):(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",(0,a.A)({type:t,name:m,value:o,onChange:b,onFocus:()=>h(!0),onBlur:()=>h(!1),className:"w-full pt-5 pb-2 px-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-science-blue focus:border-transparent"},x)),(0,n.jsx)(i.P.label,{initial:{y:18,x:16,scale:1},animate:p||o?{y:4,x:12,scale:.85}:{},className:"absolute left-0 pointer-events-none ".concat(p||o?"text-science-blue":"text-gray-500"),children:s})]})})}}}]);
//# sourceMappingURL=162.38291b7d.chunk.js.map